<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Introduction to the Python API for extending ZEISS INSPECT 2025 with Apps" name="description" />
<meta content="Metrology, ZEISS INSPECT, Python API, GOM API, Scripting, Add-ons, Apps, How-tos" name="keywords" />
    <link rel="icon" sizes="16x16" type="image/png" href="../../_static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ZEISS INSPECT Python API Introduction &mdash; App Development Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme_zeiss.css?v=dc6cf2b8" />

  
    <link rel="canonical" href="https://zeissiqs.github.io/zeiss-inspect-addon-api/main/howtos/python_api_introduction/python_api_introduction.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Selecting elements in scripts" href="selecting_elements.html" />
    <link rel="prev" title="Welcome!!!" href="../../news/welcome.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            App Development Documentation
              <img src="../../_static/zeiss-logo-rgb.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../news/news.html">What’s New</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ZEISS INSPECT Python API Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-projects">Creating projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-parts">Creating parts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-elements-to-a-part">Adding elements to a part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-cad-and-actual-mesh">Accessing CAD and actual mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-an-object-s-part">Accessing an object’s part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-all-elements-and-alignments-of-a-part">Accessing all elements and alignments of a part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-elements-and-alignments-of-element-in-clipboard">Accessing elements and alignments of <em>Element in clipboard</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="#alignments">Alignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#access-element-properties">Access element properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#explore-available-properties">Explore available properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#element-properties-in-vscode">Element properties in VSCode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#properties-of-different-stages">Properties of different stages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#element-data-interfaces">Element data interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concept">Concept</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exception-handling">Exception handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selecting_elements.html">Selecting elements in scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_app_editor/using_app_editor.html">Using the App Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_file_format/app_file_format.html">App file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_documentation/app_documentation.html">Documenting Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_vscode_editor/using_vscode_editor.html">Using Visual Studio Code as an App editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_selection_dialog.html">Selecting a file or folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_defined_dialogs.html">User-defined Dialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_wizard_dialogs.html">Creating wizard dialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_gui_libraries/using_gui_libraries.html">Using an additional Python GUI library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripted_elements/scripted_elements_toc.html">Scripted elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_script_resources.html">Using script resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stages/stages.html">Working with stages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_keywords/project_keywords.html">Project keywords handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_shared_environments/using_shared_environments.html">Using shared environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_wheelhouses/using_wheelhouses.html">Using Python wheelhouses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_workspaces_to_apps/adding_workspaces_to_apps.html">Adding workspaces to Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_services/using_services.html">Using services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../localization/localization.html">Localization of Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starting_options/starting_options.html">Software and script starting options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing_apps/testing_apps.html">Testing Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting_legacy_projects/scripting_legacy_projects.html">Scripting with legacy projects (part-less)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting_solutions/scripting_solutions.html">Scripting solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">Frequently asked questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/index.html">Introduction to the Python API Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/examples_overview.html">ZEISS INSPECT App Examples Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/python_api.html">ZEISS INSPECT App Python API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/scripted_elements_api.html">Scripted elements API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/resource_api.html">gom.Resource API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">App Development Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ZEISS INSPECT Python API Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="zeiss-inspect-python-api-introduction">
<h1>ZEISS INSPECT Python API Introduction<a class="headerlink" href="#zeiss-inspect-python-api-introduction" title="Link to this heading"></a></h1>
<p>Welcome to the ZEISS INSPECT Python API introduction. This is your starting point into App development for ZEISS INSPECT. Here you find out what you can do with Apps, how they work and how you create them.</p>
<p>See <a class="reference external" href="https://techguide.gom.com/en/zeiss-inspect-2023/article/introduction_to_python_scripting.html">Introduction to Python Scripting</a> if you are new to Python or the ZEISS INSPECT Python interface.</p>
<section id="creating-projects">
<h2>Creating projects<a class="headerlink" href="#creating-projects" title="Link to this heading"></a></h2>
<p>You can create a new, empty project as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new project</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">create_project</span> <span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This way, a project in the default workflow (part-based) is created. For the legacy workflow (part-less), please refer to <a class="reference internal" href="../scripting_legacy_projects/scripting_legacy_projects.html"><span class="std std-doc">Scripting with legacy projects (part-less)</span></a></p>
</div>
</section>
<section id="creating-parts">
<h2>Creating parts<a class="headerlink" href="#creating-parts" title="Link to this heading"></a></h2>
<p>The evaluation elements are usually placed under a “part”. Accordingly, an empty part can be created as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creates a new part in your project with the name &#39;Part 1&#39;</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">create_new_part</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Part 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An existing part can be accessed via name or index in the new category:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access the part object via name</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">]</span>
 
<span class="c1"># or via index</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 
<span class="c1"># you can access all parts via iterating over the parts attribute</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-elements-to-a-part">
<h2>Adding elements to a part<a class="headerlink" href="#adding-elements-to-a-part" title="Link to this heading"></a></h2>
<p>If an actual mesh or CAD or elements are imported into a part project, different options are available. For scripting, the import is always separated into two different steps.</p>
<ol class="arabic simple">
<li><p>Importing the elements into the <em>Elements in clipboard</em></p></li>
<li><p>Add the imported elements to a created part</p></li>
</ol>
<p>Example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">create_new_part</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Part 1&#39;</span><span class="p">)</span>
 
<span class="c1"># import element into &#39;Element in clipboard&#39;</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">import_g3d</span> <span class="p">(</span>
  <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D:/zeiss_part.g3d&#39;</span><span class="p">],</span>
  <span class="n">import_mode</span><span class="o">=</span><span class="s1">&#39;clipboard&#39;</span>
<span class="p">)</span>
 
<span class="c1"># Move it to a created part</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add_elements_to_part</span> <span class="p">(</span>
  <span class="n">delete_invisible_elements</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">clipboard</span><span class="o">.</span><span class="n">actual_elements</span><span class="p">[</span><span class="s1">&#39;zeiss_part&#39;</span><span class="p">]],</span>
  <span class="n">import_mode</span><span class="o">=</span><span class="s1">&#39;new_elements&#39;</span><span class="p">,</span>
  <span class="n">part</span><span class="o">=</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>In the same way, a CAD can be imported into a part project.</p>
<p>Constructing new elements based on elements which already belong to a part are automatically added to that part.</p>
</section>
<section id="accessing-cad-and-actual-mesh">
<h2>Accessing CAD and actual mesh<a class="headerlink" href="#accessing-cad-and-actual-mesh" title="Link to this heading"></a></h2>
<p>A <strong>mesh element</strong> of a part can be accessed in the following ways:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is usually the most elegant way and is recommended.</span>
<span class="c1"># Replacing your mesh will keep the correct parametric if you use</span>
<span class="c1"># the actual values reference (like formerly the &#39;Actual master&#39; in the part-less workflow).</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">]</span>
<span class="n">MESH_PROXY</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">ActualReference</span> <span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span>
 
<span class="c1"># If you really like to access the representing CAD Element (which is not always existing, e.g. for planning)</span>
<span class="c1"># you can access this element via</span>
<span class="n">MESH_ELEMENT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">ActualReference</span><span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span><span class="o">.</span><span class="n">actual</span>
</pre></div>
</div>
<p>The <strong>CAD</strong> of a part can be addressed in the following ways:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is usually the most elegant way and is recommended.</span>
<span class="c1"># Replacing your CAD will keep the correct parametric if you use</span>
<span class="c1"># the nominal values reference (like formerly the &#39;All CAD Group proxy&#39; in the part-less workflow)</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">]</span>
<span class="n">CAD_PROXY</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">NominalReference</span> <span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span>
 
<span class="c1"># If you really like to access the representing CAD Element (which is not always existing, e.g. for planning)</span>
<span class="c1"># you can access this element via</span>
<span class="n">CAD_ELEMENT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">NominalReference</span><span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span><span class="o">.</span><span class="n">nominal</span>
</pre></div>
</div>
</section>
<section id="accessing-an-object-s-part">
<h2>Accessing an object’s part<a class="headerlink" href="#accessing-an-object-s-part" title="Link to this heading"></a></h2>
<p>This information can be retrieved via an attribute of the object. Here is an example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">inspection</span><span class="p">[</span><span class="s1">&#39;Point 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">part</span>
</pre></div>
</div>
</section>
<section id="accessing-all-elements-and-alignments-of-a-part">
<h2>Accessing all elements and alignments of a part<a class="headerlink" href="#accessing-all-elements-and-alignments-of-a-part" title="Link to this heading"></a></h2>
<p>One possibility is to iterate over all elements in the different categories (nominal, actual, inspection, alignments) and to check the part attribute. Usually, for most applications this can be achieved easier using an <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code> (some elements are hidden and not listed, but usually you do not need access to these elements). Here is an example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;part&#39;</span><span class="p">,</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]]}):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="selecting_elements.html"><span class="std std-doc">Selecting elements in scripts</span></a> for more details.</p>
</section>
<section id="accessing-elements-and-alignments-of-element-in-clipboard">
<h2>Accessing elements and alignments of <em>Element in clipboard</em><a class="headerlink" href="#accessing-elements-and-alignments-of-element-in-clipboard" title="Link to this heading"></a></h2>
<p>Also, these elements can be easily accessed via an <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;is_element_in_clipboard&#39;</span><span class="p">,</span> <span class="s1">&#39;True&#39;</span><span class="p">]}):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="alignments">
<h2>Alignments<a class="headerlink" href="#alignments" title="Link to this heading"></a></h2>
<p>Alignments are still accessible via <code class="docutils literal notranslate"><span class="pre">gom.app.project.alignments</span></code> (like in the legacy workflow). The same is valid for <code class="docutils literal notranslate"><span class="pre">gom.app.project.nominal_elements</span></code>, <code class="docutils literal notranslate"><span class="pre">gom.app.project.actual_elements</span></code> and <code class="docutils literal notranslate"><span class="pre">gom.app.project.inspection</span></code>. You have to keep in mind that you will get all elements or alignments of all parts. You can use the <code class="docutils literal notranslate"><span class="pre">part</span></code> token to establish to which part an alignment belongs to or you use an <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code> (see examples above):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;part&#39;</span><span class="p">,</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">],</span> <span class="s1">&#39;explorer_category&#39;</span><span class="p">,</span> <span class="s1">&#39;alignment&#39;</span><span class="p">]}):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>There is one special handling for multiple parts and scripting with the <em>Original alignment</em>. To distinguish these alignments for different parts, the scripting name contains the part name and is modified into:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">alignments</span><span class="p">[</span><span class="s1">&#39;&lt;Name of the part&gt;::Original alignment&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="access-element-properties">
<h2>Access element properties<a class="headerlink" href="#access-element-properties" title="Link to this heading"></a></h2>
<p>The “elements” of the GOM Software, i.e. what you see in the element explorer of your project, hold several properties and data which you can access using the Python API.</p>
<p>First of all, you need a reference to an element, which you can get either by <a class="reference internal" href="user_defined_dialogs.html"><span class="std std-doc">using a script dialog</span></a> or simply by referencing it by name.</p>
<p>If you have installed the <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">API</span> <span class="pre">Examples</span></code> App from the store and loaded the <code class="docutils literal notranslate"><span class="pre">zeiss_part_test_project</span></code> (see the <a class="reference internal" href="../../python_examples/index.html"><span class="std std-doc">Python API Examples Documentation</span></a>), you can reference the mesh like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_element</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span>
</pre></div>
</div>
<section id="explore-available-properties">
<h3>Explore available properties<a class="headerlink" href="#explore-available-properties" title="Link to this heading"></a></h3>
<p>Once you have a reference to an element, you can access its properties using several keywords in the form <code class="docutils literal notranslate"><span class="pre">element.&lt;keyword&gt;</span></code>.</p>
<p>One way to inspect the available keys is by using the ‘Script Object’ explorer, which is available from the Script Editor’s context menu: RMB ► Insert ► Element Value (shortcut <code class="docutils literal notranslate"><span class="pre">F2</span></code>).</p>
<a class="reference internal image-reference" href="../../_images/insert_element_value.png"><img alt="Insert Element Value" src="../../_images/insert_element_value.png" style="width: 350px;" /></a>
<a class="reference internal image-reference" href="../../_images/script_object_explorer.png"><img alt="Script Object Explorer" src="../../_images/script_object_explorer.png" style="width: 350px;" /></a>
<p>You will find several keywords in the Object Explorer, with a preview of the current value.
If you click <code class="docutils literal notranslate"><span class="pre">OK</span></code>, the complete call, including element reference by name, will be copied to your current script. If you already have a name reference, you can of course use this reference.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_element</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mesh_element</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">207422.1875</span>
</pre></div>
</div>
</section>
<section id="element-properties-in-vscode">
<h3>Element properties in VSCode<a class="headerlink" href="#element-properties-in-vscode" title="Link to this heading"></a></h3>
<p>Using Visual Studio Code, you can get auto-completion for the usable keywords directly in a pop-up.</p>
<p><img alt="Keywords in VSCode" src="../../_images/inserting_keywords.png" /></p>
<p>See <a class="reference internal" href="../using_vscode_editor/using_vscode_editor.html"><span class="std std-doc">Using VSCode Editor</span></a> for details.</p>
</section>
<section id="properties-of-different-stages">
<h3>Properties of different stages<a class="headerlink" href="#properties-of-different-stages" title="Link to this heading"></a></h3>
<p>If you are using a multi-stage project, the approach as described above will always give you the element properties in the current stage. If you need access to properties in a different stage, you can use the <code class="docutils literal notranslate"><span class="pre">in_stage[s]</span></code> modifier:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_element</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mesh_element</span><span class="o">.</span><span class="n">in_stage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">207422.1875</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stage indices start with index <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</div>
<p>In this way, you can get simple properties of a different stage. If you need access to data of all stages at once, especially for larger data (like arrays of vertices), use “Data interfaces” as described below.</p>
</section>
</section>
<section id="element-data-interfaces">
<h2>Element data interfaces<a class="headerlink" href="#element-data-interfaces" title="Link to this heading"></a></h2>
<p>In a script, each element present in the application (project, inspection elements, reports, …) can be referenced by a named identifier. Each identifier consists of a type and some index, which can be a name or an integer number.</p>
<section id="concept">
<h3>Concept<a class="headerlink" href="#concept" title="Link to this heading"></a></h3>
<p>This is already the case for access via the data interface instead of the token interface: The returned value has the format <code class="docutils literal notranslate"><span class="pre">(stages,</span> <span class="pre">&lt;index</span> <span class="pre">dimensions&gt;)</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Example 1 - Mesh</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mesh in 8 stage trend project with 238654 points, each with one (x, y, z) triple</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">238654</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Example 2 - Scalar value</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single scalar value in a 8 stages trend project</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">inspection</span><span class="p">[</span><span class="s1">&#39;My Check&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">result_dimension</span><span class="o">.</span><span class="n">deviation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Example 3 - Image</span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Image in 8 stage trend project with 4000x3000 pixels, each with one (r, g, b, a) tuple</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">measurement_list</span><span class="p">[</span><span class="s1">&#39;Scan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="s1">&#39;Left camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When accessing the image, the complete data set is <em>not</em> transferred immediately from C++ to Python! Instead this happens just in the moment when it is converted into a numpy array!</p>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Example 4 - Transferring image data</span><a class="headerlink" href="#id4" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch gom.Array with image data in all stages (not transferred !)</span>
<span class="o">&gt;</span> <span class="n">image</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">measurement_list</span><span class="p">[</span><span class="s1">&#39;Scan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="s1">&#39;Left camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rgb</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">type</span> <span class="p">(</span><span class="n">image</span><span class="p">))</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">gom</span><span class="o">.</span><span class="n">Array</span> <span class="p">()</span>
<span class="c1"># 45 MB Image data if on stage, transferred in &lt; 100 ms</span>
<span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<!--
About the notation:
We thought about this for quite a long time. The problem is, that we have multiple data dimensions on one hand (elements, stages, indices, alignments), but just one index operator '[]' on the other hand. We cannot mix this up like {{A[element name].B[stage]...}}.
Well, this is not entirely true, as expressions like {{gom.app.project.actual['Mesh'].coordinate[1000]}} are possible, but in this case at least the index is (element, element, element, ..., point) and not something when a stage of point is in the middle of the path.

So the following procedure is recommended:
* Evaluate if the staged {{data}} tokens plus the regular stageless global tokens are sufficient.
* If it is really necessary to access a token which is not delivered via a data interface in another stage, we must think again.
* Global stage switching cannot be the solution in UDEs at all, of course. So I would prefer something like this *if really necessary* 

Example:

```Python
current_stage = context.stage
context.stage = 14
# Query token in stage 14
value = gom.app.project.nominal['Nominal value'].scalar_value
context.stage = current_stage
```

* This will not switch stages, but all future token queries of this UDE script run will use stage 14.
* Of course, this can be done much more simple with:

```Python
# Deformation project with 800 stages
> values = gom.app.project.nominal['Nominal value'].data.scalar_value
> print (value.shape)
(800, 1)
```

-->
</section>
</section>
<section id="exception-handling">
<h2>Exception handling<a class="headerlink" href="#exception-handling" title="Link to this heading"></a></h2>
<p>With the ZEISS INSPECT App API, three different types of exceptions can occur:</p>
<ul class="simple">
<li><p>Python built-in exceptions</p></li>
<li><p>User defined exceptions, e.g. from a Python module</p></li>
<li><p>ZEISS INSPECT App API exceptions</p></li>
</ul>
<p>It is <a class="reference external" href="https://pylint.readthedocs.io/en/latest/user_guide/messages/warning/bare-except.html">recommended practice</a> to avoid bare except clauses, i.e. to specify an exception type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">calling_for_trouble</span><span class="p">()</span> <span class="c1"># could raise an exception</span>
<span class="k">except</span> <span class="o">&lt;</span><span class="n">exception_type</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="c1"># exception handling</span>
</pre></div>
</div>
<p>If the type of exception is unknown, it can be identified as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">calling_for_trouble</span><span class="p">()</span> <span class="c1"># could raise an exception; type unknown yet</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># e.g.: &lt;class &#39;gomlib.api.GomApiError&#39;&gt;</span>
</pre></div>
</div>
<p>Now you can specify the expected exception type correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gomlib</span>
<span class="o">...</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">calling_for_trouble</span><span class="p">()</span> <span class="c1"># could raise a GomApiError exception</span>
<span class="k">except</span> <span class="n">gomlib</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">GomApiError</span><span class="p">:</span>
    <span class="c1"># exception handling</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../news/welcome.html" class="btn btn-neutral float-left" title="Welcome!!!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="selecting_elements.html" class="btn btn-neutral float-right" title="Selecting elements in scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Carl Zeiss GOM Metrology GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
  <p></p>
  <div class="footer">
    <a href="https://www.gom.com/en/imprint" target="_blank" rel="noopener noreferrer">Imprint</a>
  </div>
  <jinja2.runtime.BlockReference object at 0x7fe58d0255a0>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>