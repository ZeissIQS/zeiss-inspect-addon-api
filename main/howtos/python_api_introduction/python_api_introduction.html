<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Introduction to the Python API for extending ZEISS INSPECT 2023 with Add-ons" name="description" />
<meta content="Metrology, ZEISS INSPECT, Python API, GOM API, Scripting, Add-ons, How-tos" name="keywords" />
    <link rel="icon" sizes="16x16" type="image/png" href="../../_static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ZEISS INSPECT Python API Introduction &mdash; Add-On Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme_zeiss.css?v=dc6cf2b8" />

  
    <link rel="canonical" href="https://zeissiqs.github.io/zeiss-inspect-addon-api/2023/howtos/python_api_introduction/python_api_introduction.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using the Add-on Editor" href="../using_add_on_editor/using_add_on_editor.html" />
    <link rel="prev" title="Welcome!!!" href="../../news/welcome.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Add-On Documentation
              <img src="../../_static/zeiss-logo-rgb.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../news/news.html">What’s New</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ZEISS INSPECT Python API Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-projects">Creating projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-parts">Creating parts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-elements-to-a-part">Adding elements to a part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-cad-and-actual-mesh">Accessing CAD and actual mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-an-object-s-part">Accessing an object’s part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-all-elements-and-alignments-of-a-part">Accessing all elements and alignments of a part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-elements-and-alignments-of-element-in-clipboard">Accessing elements and alignments of <em>Element in clipboard</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="#alignments">Alignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#legacy-projects-part-less">Legacy projects (part-less)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#measurement-series-and-measuring-environment">Measurement series and Measuring environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reports">Reports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cad-structure-and-contents">CAD structure and contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cad-assembly-structure-in-the-elements-in-clipboard">CAD assembly structure in the <em>Elements in clipboard</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#script-compatibility">Script compatibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#actual-master-and-all-cad-group-proxy">Actual master and All CAD Group proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#measurement-series">Measurement series</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tesselate-geometrical-element">Tesselate Geometrical Element</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#access-element-properties">Access element properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#explore-available-properties">Explore available properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#element-properties-in-vscode">Element properties in VSCode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#properties-of-different-stages">Properties of different stages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#element-data-interfaces">Element data interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concept">Concept</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exception-handling">Exception handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_add_on_editor/using_add_on_editor.html">Using the Add-on Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../add_on_file_format/add_on_file_format.html">Add-on file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../add_on_documentation/add_on_documentation.html">Documenting Add-ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_vscode_editor/using_vscode_editor.html">Using Visual Studio Code as an add-on editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_defined_dialogs.html">User-defined Dialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_wizard_dialogs.html">Creating wizard dialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_gui_libraries/using_gui_libraries.html">Using an additional Python GUI library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripted_elements/scripted_elements_toc.html">Scripted elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_script_resources.html">Using script resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stages/stages.html">Working with stages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_keywords/project_keywords.html">Project keywords handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_shared_environments/using_shared_environments.html">Using shared environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_wheelhouses/using_wheelhouses.html">Using Python wheelhouses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_workspaces_to_addons/adding_workspaces_to_addons.html">Adding workspaces to add-ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../localization/localization.html">Localization of Add-ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../starting_options/starting_options.html">Software and script starting options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing_addons/testing_addons.html">Testing add-ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">Frequently asked questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/index.html">ZEISS INSPECT Python API Examples Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/data_interfaces.html">data_interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/point_pixel_transformations.html">point_pixel_transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/dialog_widgets.html">dialog_widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/misc.html">misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/script_icons.html">script_icons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/script_resources.html">script_resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/scripted_actuals.html">scripted_actuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_examples/scripted_checks.html">scripted_checks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/python_api.html">ZEISS INSPECT Python API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/scripted_elements_api.html">Scripted elements API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/resource_api.html">gom.Resource API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Add-On Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ZEISS INSPECT Python API Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="zeiss-inspect-python-api-introduction">
<h1>ZEISS INSPECT Python API Introduction<a class="headerlink" href="#zeiss-inspect-python-api-introduction" title="Link to this heading"></a></h1>
<p>Welcome to the ZEISS INSPECT Python API introduction. This is your starting point into Add-on development for ZEISS INSPECT. Here you find out what you can do with Add-ons, how they work and how you create them.</p>
<p>See <a class="reference external" href="https://techguide.gom.com/en/zeiss-inspect-2023/article/introduction_to_python_scripting.html">Introduction to Python Scripting</a> if you are new to Python or the ZEISS INSPECT Python interface.</p>
<section id="creating-projects">
<h2>Creating projects<a class="headerlink" href="#creating-projects" title="Link to this heading"></a></h2>
<p>You can create a new, empty project as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new project</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">create_project</span> <span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>💡 This way, a project in the default workflow  (part-based) is created. For the legacy workflow (part-less), please refer to <a class="reference internal" href="#legacy-projects-part-less">Legacy projects (part-less)</a></p>
</div>
</section>
<section id="creating-parts">
<h2>Creating parts<a class="headerlink" href="#creating-parts" title="Link to this heading"></a></h2>
<p>The evaluation elements are usually placed under a “part”. Accordingly, an empty part can be created as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creates a new part in your project with the name &#39;Part 1&#39;</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">create_new_part</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Part 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An existing part can be accessed via name or index in the new category:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access the part object via name</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">]</span>
 
<span class="c1"># or via index</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 
<span class="c1"># you can access all parts via iterating over the parts attribute</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-elements-to-a-part">
<h2>Adding elements to a part<a class="headerlink" href="#adding-elements-to-a-part" title="Link to this heading"></a></h2>
<p>If an actual mesh or CAD or elements are imported into a part project, different options are available. For scripting, the import is always separated into two different steps.</p>
<ol class="arabic simple">
<li><p>Importing the elements into the <em>Elements in clipboard</em></p></li>
<li><p>Add the imported elements to a created part</p></li>
</ol>
<p>Example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">create_new_part</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Part 1&#39;</span><span class="p">)</span>
 
<span class="c1"># import element into &#39;Element in clipboard&#39;</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">import_g3d</span> <span class="p">(</span>
  <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D:/gom_part.g3d&#39;</span><span class="p">],</span>
  <span class="n">import_mode</span><span class="o">=</span><span class="s1">&#39;clipboard&#39;</span>
<span class="p">)</span>
 
<span class="c1"># Move it to a created part</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add_elements_to_part</span> <span class="p">(</span>
  <span class="n">delete_invisible_elements</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">clipboard</span><span class="o">.</span><span class="n">actual_elements</span><span class="p">[</span><span class="s1">&#39;gom_part&#39;</span><span class="p">]],</span>
  <span class="n">import_mode</span><span class="o">=</span><span class="s1">&#39;new_elements&#39;</span><span class="p">,</span>
  <span class="n">part</span><span class="o">=</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>In the same way, a CAD can be imported into a part project.</p>
<p>Constructing new elements based on elements which already belong to a part are automatically added to that part.</p>
</section>
<section id="accessing-cad-and-actual-mesh">
<h2>Accessing CAD and actual mesh<a class="headerlink" href="#accessing-cad-and-actual-mesh" title="Link to this heading"></a></h2>
<p>A <strong>mesh element</strong> of a part can be accessed in the following ways:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is usually the most elegant way and is recommended.</span>
<span class="c1"># Replacing your mesh will keep the correct parametric if you use</span>
<span class="c1"># the actual values reference (like formerly the &#39;Actual master&#39; in the part-less workflow).</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">]</span>
<span class="n">MESH_PROXY</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">ActualReference</span> <span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span>
 
<span class="c1"># If you really like to access the representing CAD Element (which is not always existing, e.g. for planning)</span>
<span class="c1"># you can access this element via</span>
<span class="n">MESH_ELEMENT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">ActualReference</span><span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span><span class="o">.</span><span class="n">actual</span>
</pre></div>
</div>
<p>The <strong>CAD</strong> of a part can be addressed in the following ways:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is usually the most elegant way and is recommended.</span>
<span class="c1"># Replacing your CAD will keep the correct parametric if you use</span>
<span class="c1"># the nominal values reference (like formerly the &#39;All CAD Group proxy&#39; in the part-less workflow)</span>
<span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part 1&#39;</span><span class="p">]</span>
<span class="n">CAD_PROXY</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">NominalReference</span> <span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span>
 
<span class="c1"># If you really like to access the representing CAD Element (which is not always existing, e.g. for planning)</span>
<span class="c1"># you can access this element via</span>
<span class="n">CAD_ELEMENT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">NominalReference</span><span class="p">(</span><span class="n">PART_OBJECT</span><span class="p">)</span><span class="o">.</span><span class="n">nominal</span>
</pre></div>
</div>
</section>
<section id="accessing-an-object-s-part">
<h2>Accessing an object’s part<a class="headerlink" href="#accessing-an-object-s-part" title="Link to this heading"></a></h2>
<p>This information can be retrieved via an attribute of the object. Here is an example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">PART_OBJECT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">inspection</span><span class="p">[</span><span class="s1">&#39;Point 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">part</span>
</pre></div>
</div>
</section>
<section id="accessing-all-elements-and-alignments-of-a-part">
<h2>Accessing all elements and alignments of a part<a class="headerlink" href="#accessing-all-elements-and-alignments-of-a-part" title="Link to this heading"></a></h2>
<p>One possibility is to iterate over all elements in the different categories (nominal, actual, inspection, alignments) and to check the part attribute. Usually, for most applications this can be achieved easier using an <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code> (some elements are hidden and not listed, but usually you do not need access to these elements). Here is an example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;part&#39;</span><span class="p">,</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]]}):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="accessing-elements-and-alignments-of-element-in-clipboard">
<h2>Accessing elements and alignments of <em>Element in clipboard</em><a class="headerlink" href="#accessing-elements-and-alignments-of-element-in-clipboard" title="Link to this heading"></a></h2>
<p>Also, these elements can be easily accessed via an <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;is_element_in_clipboard&#39;</span><span class="p">,</span> <span class="s1">&#39;True&#39;</span><span class="p">]}):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="alignments">
<h2>Alignments<a class="headerlink" href="#alignments" title="Link to this heading"></a></h2>
<p>Alignments are still accessible via <code class="docutils literal notranslate"><span class="pre">gom.app.project.alignments</span></code> (like in the legacy workflow). The same is valid for <code class="docutils literal notranslate"><span class="pre">gom.app.project.nominal_elements</span></code>, <code class="docutils literal notranslate"><span class="pre">gom.app.project.actual_elements</span></code> and <code class="docutils literal notranslate"><span class="pre">gom.app.project.inspection</span></code>. You have to keep in mind that you will get all elements or alignments of all parts. You can use the <code class="docutils literal notranslate"><span class="pre">part</span></code> token to establish to which part an alignment belongs to or you use an <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code> (see examples above):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;part&#39;</span><span class="p">,</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">],</span> <span class="s1">&#39;explorer_category&#39;</span><span class="p">,</span> <span class="s1">&#39;alignment&#39;</span><span class="p">]}):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>There is one special handling for multiple parts and scripting with the <em>Original alignment</em>. To distinguish these alignments for different parts, the scripting name contains the part name and is modified into:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">alignments</span><span class="p">[</span><span class="s1">&#39;&lt;Name of the part&gt;::Original alignment&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="legacy-projects-part-less">
<h2>Legacy projects (part-less)<a class="headerlink" href="#legacy-projects-part-less" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>⚠️ You can skip this section unless you are dealing with legacy projects!</p>
</div>
<p>As shown above, the following code creates a project in the part-based workflow, which allows to analyze multiple parts:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a project (default; part-based workflow)</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">create_project</span> <span class="p">()</span>

<span class="c1"># For compatibility, the kind of project can be stated explicitely:</span>
<span class="c1"># Create a project (part-based workflow)</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">create_project</span> <span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="mi">2018</span><span class="p">)</span>
</pre></div>
</div>
<p>You can still create a project in the legacy workflow, which is restricted to a single part:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a project (part-less workflow)</span>
<span class="c1"># Note: This allows to analyze a single part only!</span>
<span class="n">gom</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">create_project</span> <span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="mi">2016</span><span class="p">)</span>
</pre></div>
</div>
<p>Use the following code to determine the type of an existing project:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">is_part_project</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Is part project: True&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Is part project: False&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In former projects, the CAD or the actual mesh have been accessed via their proxies:</p>
<p><em>All CADGroup proxy</em></p>
<p><em>Actual Master</em></p>
<section id="measurement-series-and-measuring-environment">
<h3>Measurement series and Measuring environment<a class="headerlink" href="#measurement-series-and-measuring-environment" title="Link to this heading"></a></h3>
<p>The access and information about the VMR, measuring setups and measurement series  are much more separated in the part-based workflow as compared to the part-less workflow. New categories and <code class="docutils literal notranslate"><span class="pre">ElementSelection</span></code> categories were introduced. If you have further questions regarding scripting purposes, please contact the ZEISS support.</p>
<p>Here just the most important information follows. The measurements have their own category in the part-based workflow. A measurement can be accessed via the attribute <code class="docutils literal notranslate"><span class="pre">measurement_series</span></code> and no longer via <code class="docutils literal notranslate"><span class="pre">actual_elements</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">MEASUREMENT</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">measurement_series</span><span class="p">[</span><span class="s1">&#39;Scan 1&#39;</span><span class="p">]</span>
 
<span class="n">MEASUREMENTS</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">ElementSelection</span> <span class="p">({</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;elements&#39;</span><span class="p">,</span> <span class="s1">&#39;explorer_category&#39;</span><span class="p">,</span> <span class="s1">&#39;measurements&#39;</span><span class="p">,</span> <span class="s1">&#39;object_family&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_series&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</section>
<section id="reports">
<h3>Reports<a class="headerlink" href="#reports" title="Link to this heading"></a></h3>
<p>Reports did not change so much in the part-based workflow. Reports are not assigned to a part, they show the situation of measurement series, VMR or multiple parts at the same time. Some slight changes must be taken into account: The keyword <code class="docutils literal notranslate"><span class="pre">alignment</span></code> could now return names of more than one alignment (comma separated, i.e. a Python list) due to the fact that multiple parts (if visible in the report page) with their own alignment must be respected.</p>
</section>
<section id="cad-structure-and-contents">
<h3>CAD structure and contents<a class="headerlink" href="#cad-structure-and-contents" title="Link to this heading"></a></h3>
<p>For scripting with CADs in part-based projects, some additional information are necessary. Most importantly:</p>
<p>Only one CAD Group per part is supported. <!-- The same also applies to the actual content of a part - only one mesh per part is supported. --></p>
<!-- 
How about stages?

The following code prints the surface area of each stage:

for s in gom.app.project.stages:
	print (gom.app.project.parts['Part'].actual.in_stage[s.index].area)

According to this, the stage (i.e. a mesh) would be a sub-element of the part. Or does this have anything to do with a proxy?
-->
<p>The <em>CAD Group</em> (in a part-based workflow) supports now the access via an internal file structure to represent structures stored in CAD files like <em>CATProduct</em>. These entities are imported in the part-less workflow as separated <em>CAD Groups</em>.</p>
<p>The following simple code examples show how to access bodies or files of a CAD Group.</p>
<p>⚠️ <strong>Keep in mind:</strong> This access gives you information about the bodies or files. You can use this also for the deletion of bodies. Visibility operations are suppressed by intention. Usage for construction purposes is not recommended due to the fact that exchanging CAD structures would <strong>not</strong> work as expected.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this example code list all bodies of all CADs for all parts</span>
<span class="n">cad</span> <span class="o">=</span> <span class="nb">filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;cad&quot;</span><span class="p">,</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">nominal_elements</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cad</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">bodies</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>This is an example to list files by <code class="docutils literal notranslate"><span class="pre">cat_part</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">cad</span> <span class="o">=</span> <span class="nb">filter</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;cad&quot;</span><span class="p">,</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">nominal_elements</span><span class="p">)</span>
 
<span class="c1"># for all cads in all parts list the file structure of each CAD of one part and furthermore all bodies of each file</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cad</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Number of files: &#39;</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="nb">len</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">file</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">bodies</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39; </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="cad-assembly-structure-in-the-elements-in-clipboard">
<h3>CAD assembly structure in the <em>Elements in clipboard</em><a class="headerlink" href="#cad-assembly-structure-in-the-elements-in-clipboard" title="Link to this heading"></a></h3>
<p>These information are usually not necessary for scripting. The most important fact is that the assembly structure does not represent our CAD structure. The assembly structure shows much more internal details.</p>
</section>
<section id="script-compatibility">
<h3>Script compatibility<a class="headerlink" href="#script-compatibility" title="Link to this heading"></a></h3>
<section id="actual-master-and-all-cad-group-proxy">
<h4>Actual master and All CAD Group proxy<a class="headerlink" href="#actual-master-and-all-cad-group-proxy" title="Link to this heading"></a></h4>
<p>For the single part workflow old scripts using <em>Actual Master</em> and the <em>All CAD Group proxy</em> in creation commands should usually work.</p>
<p>⚠️ <strong>Keep in mind:</strong> The functionality of these proxies is no longer present in the part-based workflow. Therefore functionalities like <em>Define Actual Master</em> will not work anymore. If the scripting tries to resolve the elements for the <em>Actual Master</em> a mapping takes place and the <em>ActualValues-Reference</em> of the unique part is returned. The same happens for the <em>All CAD Group proxy</em> and the <em>NominalValues-Reference</em>.</p>
</section>
<section id="measurement-series">
<h4>Measurement series<a class="headerlink" href="#measurement-series" title="Link to this heading"></a></h4>
<p>The script compatibility for the current measurement list is given in most cases. Normal information is usually accessible via the same attributes as before.</p>
</section>
<section id="tesselate-geometrical-element">
<h4>Tesselate Geometrical Element<a class="headerlink" href="#tesselate-geometrical-element" title="Link to this heading"></a></h4>
<p>The obsolete command <code class="docutils literal notranslate"><span class="pre">gom.script.mesh.tesselate_geometrical_element</span></code> creates an element of type mesh.</p>
<p>In the part-based workflow this command has been replaced with the command <code class="docutils literal notranslate"><span class="pre">gom.script.primitive.tesselate_geometrical_element</span></code>, which creates elements of type surface.</p>
</section>
</section>
</section>
<section id="access-element-properties">
<h2>Access element properties<a class="headerlink" href="#access-element-properties" title="Link to this heading"></a></h2>
<p>The “elements” of the GOM Software, i.e. what you see in the element explorer of your project, hold several properties and data which you can access using the Python API.</p>
<p>First of all, you need a reference to an element, which you can get either by <a class="reference internal" href="user_defined_dialogs.html"><span class="std std-doc">using a script dialog</span></a> or simply by referencing it by name.</p>
<p>If you have installed the <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">API</span> <span class="pre">Examples</span></code> add-on from the store and loaded the <code class="docutils literal notranslate"><span class="pre">gom_part_test_project</span></code> (see the <a class="reference internal" href="../../python_examples/index.html"><span class="std std-doc">Python API Examples Documentation</span></a>), you can reference the mesh like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_element</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span>
</pre></div>
</div>
<section id="explore-available-properties">
<h3>Explore available properties<a class="headerlink" href="#explore-available-properties" title="Link to this heading"></a></h3>
<p>Once you have a reference to the element, you can access its properties using several keywords in the form <code class="docutils literal notranslate"><span class="pre">element.&lt;keyword&gt;</span></code>.</p>
<p>One way to inspect the available keys is by using the ‘Script Object’ explorer, which is available from the context menu <code class="docutils literal notranslate"><span class="pre">-&gt;</span> <span class="pre">Insert</span> <span class="pre">-&gt;</span> <span class="pre">Element</span> <span class="pre">Value</span></code> or by shortcut <code class="docutils literal notranslate"><span class="pre">F2</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/script_object_explorer.jpg"><img alt="Script Object Explorer" src="../../_images/script_object_explorer.jpg" style="width: 350px;" /></a>
<p>You will find several keywords there, with a preview of the current value.
If you click <code class="docutils literal notranslate"><span class="pre">OK</span></code>, the complete call, including element reference by name, will be copied to your current script. If you already have a name reference, you can of course use this reference.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_element</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mesh_element</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">207422.1875</span>
</pre></div>
</div>
</section>
<section id="element-properties-in-vscode">
<h3>Element properties in VSCode<a class="headerlink" href="#element-properties-in-vscode" title="Link to this heading"></a></h3>
<p>Using Visual Studio Code, you can get auto-completion for the usable keywords directly in a pop-up.</p>
<p><img alt="Keywords in VSCode" src="../../_images/inserting_keywords.png" /></p>
<p>See <a class="reference internal" href="../using_vscode_editor/using_vscode_editor.html"><span class="std std-doc">Using VSCode Editor</span></a> for details.</p>
</section>
<section id="properties-of-different-stages">
<h3>Properties of different stages<a class="headerlink" href="#properties-of-different-stages" title="Link to this heading"></a></h3>
<p>If you are using a multi-stage project, the approach as described above will always give you the element properties in the current stage. If you need access to properties in a different stage, you can use the <code class="docutils literal notranslate"><span class="pre">in_stage[s]</span></code> modifier:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_element</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mesh_element</span><span class="o">.</span><span class="n">in_stage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">207422.1875</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stage indices start with index <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</div>
<p>In this way, you can get simple properties of a different stage. If you need access to data of all stages at once, especially for larger data (like arrays of vertices), use “Data interfaces” as described below.</p>
</section>
</section>
<section id="element-data-interfaces">
<h2>Element data interfaces<a class="headerlink" href="#element-data-interfaces" title="Link to this heading"></a></h2>
<p>In a script, each element present in the application (project, inspection elements, reports, …) can be referenced by a named identifier. Each identifier consists of a type and some index, which can be a name or an integer number.</p>
<section id="concept">
<h3>Concept<a class="headerlink" href="#concept" title="Link to this heading"></a></h3>
<p>This is already the case for access via the data interface instead of the token interface: The returned value has the format <code class="docutils literal notranslate"><span class="pre">(stages,</span> <span class="pre">&lt;index</span> <span class="pre">dimensions&gt;)</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Example 1 - Mesh</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mesh in 8 stage trend project with 238654 points, each with one (x, y, z) triple</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;Part&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actual</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">238654</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Example 2 - Scalar value</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single scalar value in a 8 stages trend project</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">inspection</span><span class="p">[</span><span class="s1">&#39;My Check&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">result_dimension</span><span class="o">.</span><span class="n">deviation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Example 3 - Image</span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Image in 8 stage trend project with 4000x3000 pixels, each with one (r, g, b, a) tuple</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">measurement_list</span><span class="p">[</span><span class="s1">&#39;Scan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="s1">&#39;Left camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>⚠️ When accessing the image, the complete data set is <em>not</em> transferred immediately from C++ to Python! Instead this happens just in the moment when it is converted into a numpy array!</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Example 4 - Transferring image data</span><a class="headerlink" href="#id4" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch gom.Array with image data in all stages (not transferred !)</span>
<span class="o">&gt;</span> <span class="n">image</span> <span class="o">=</span> <span class="n">gom</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">measurement_list</span><span class="p">[</span><span class="s1">&#39;Scan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">measurement</span><span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="s1">&#39;Left camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">rgb</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">type</span> <span class="p">(</span><span class="n">image</span><span class="p">))</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">gom</span><span class="o">.</span><span class="n">Array</span> <span class="p">()</span>
<span class="c1"># 45 MB Image data if on stage, transferred in &lt; 100 ms</span>
<span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="o">&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<!--
About the notation:
We thought about this for quite a long time. The problem is, that we have multiple data dimensions on one hand (elements, stages, indices, alignments), but just one index operator '[]' on the other hand. We cannot mix this up like {{A[element name].B[stage]...}}.
Well, this is not entirely true, as expressions like {{gom.app.project.actual['Mesh'].coordinate[1000]}} are possible, but in this case at least the index is (element, element, element, ..., point) and not something when a stage of point is in the middle of the path.

So the following procedure is recommended:
* Evaluate if the staged {{data}} tokens plus the regular stageless global tokens are sufficient.
* If it is really necessary to access a token which is not delivered via a data interface in another stage, we must think again.
* Global stage switching cannot be the solution in UDEs at all, of course. So I would prefer something like this *if really necessary* 

Example:

```Python
current_stage = context.stage
context.stage = 14
# Query token in stage 14
value = gom.app.project.nominal['Nominal value'].scalar_value
context.stage = current_stage
```

* This will not switch stages, but all future token queries of this UDE script run will use stage 14.
* Of course, this can be done much more simple with:

```Python
# Deformation project with 800 stages
> values = gom.app.project.nominal['Nominal value'].data.scalar_value
> print (value.shape)
(800, 1)
```

-->
</section>
</section>
<section id="exception-handling">
<h2>Exception handling<a class="headerlink" href="#exception-handling" title="Link to this heading"></a></h2>
<p>With the ZEISS INSPECT Add-on API, three different types of exceptions can occur:</p>
<ul class="simple">
<li><p>Python built-in exceptions</p></li>
<li><p>User defined exceptions, e.g. from a Python module</p></li>
<li><p>ZEISS INSPECT Add-on API exceptions</p></li>
</ul>
<p>It is <a class="reference external" href="https://pylint.readthedocs.io/en/latest/user_guide/messages/warning/bare-except.html">recommended practice</a> to avoid bare except clauses, i.e. to specify an exception type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">calling_for_trouble</span><span class="p">()</span> <span class="c1"># could raise an exception</span>
<span class="k">except</span> <span class="o">&lt;</span><span class="n">exception_type</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="c1"># exception handling</span>
</pre></div>
</div>
<p>If the type of exception is unknown, it can be identified as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">calling_for_trouble</span><span class="p">()</span> <span class="c1"># could raise an exception; type unknown yet</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># e.g.: &lt;class &#39;gomlib.api.GomApiError&#39;&gt;</span>
</pre></div>
</div>
<p>Now you can specify the expected exception type correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gomlib</span>
<span class="o">...</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">calling_for_trouble</span><span class="p">()</span> <span class="c1"># could raise a GomApiError exception</span>
<span class="k">except</span> <span class="n">gomlib</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">GomApiError</span><span class="p">:</span>
    <span class="c1"># exception handling</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../news/welcome.html" class="btn btn-neutral float-left" title="Welcome!!!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../using_add_on_editor/using_add_on_editor.html" class="btn btn-neutral float-right" title="Using the Add-on Editor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Carl Zeiss GOM Metrology GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
  <p></p>
  <div class="footer">
    <a href="https://www.gom.com/en/imprint" target="_blank" rel="noopener noreferrer">Imprint</a>
  </div>
  <jinja2.runtime.BlockReference object at 0x7f2c436f4d90>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>